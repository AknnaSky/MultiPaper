From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: PureGero <puregero@gmail.com>
Date: Mon, 18 Jan 2021 20:05:06 +1000
Subject: [PATCH] Fix banned players, whitelists and ops getting reset when a
 new server is added to the network


diff --git a/src/main/java/net/minecraft/server/players/JsonList.java b/src/main/java/net/minecraft/server/players/JsonList.java
index bb58172148c8eb836ac17681e0219761bd543552..f7528c60a36ae1f03896408ee30375c5f711bf8d 100644
--- a/src/main/java/net/minecraft/server/players/JsonList.java
+++ b/src/main/java/net/minecraft/server/players/JsonList.java
@@ -184,12 +184,19 @@ public abstract class JsonList<K, V extends JsonListEntry<K>> {
     }
 
     public void load() throws IOException {
-        if (this.c.exists()) {
+        if (true || this.c.exists()) { // MultiPaper
             BufferedReader bufferedreader = null; // Files.newReader(this.c, StandardCharsets.UTF_8); // MultiPaper
             Throwable throwable = null;
-
+            
+            // MultiPaper start
+            String json = MultiPaper.readJson(this.c.getName());
+            if (json == null || json.isEmpty()) {
+                return;
+            }
+            // MultiPaper end
+            
             try {
-                JsonArray jsonarray = JsonList.b.fromJson(MultiPaper.readJson(this.c.getName()), JsonArray.class); // (JsonArray) JsonList.b.fromJson(bufferedreader, JsonArray.class); // MultiPaper
+                JsonArray jsonarray = JsonList.b.fromJson(json, JsonArray.class); // (JsonArray) JsonList.b.fromJson(bufferedreader, JsonArray.class); // MultiPaper
                 com.google.common.base.Preconditions.checkState(jsonarray != null, "The file \"" + this.c.getName() + "\" is either empty or corrupt"); // Paper
 
                 this.d.clear();
