From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: PureGero <puregero@gmail.com>
Date: Tue, 30 Mar 2021 00:28:39 +1000
Subject: [PATCH] Fix ConcurrentModificationException


diff --git a/src/main/java/puregero/multipaper/MultiPaper.java b/src/main/java/puregero/multipaper/MultiPaper.java
index d314df60db8c476a64925fbfb7dcba29f1d9d51b..959edb0619af3dd15810f1e7694752f24914cf37 100644
--- a/src/main/java/puregero/multipaper/MultiPaper.java
+++ b/src/main/java/puregero/multipaper/MultiPaper.java
@@ -29,6 +29,7 @@ import org.bukkit.entity.Player;
 
 import java.io.*;
 import java.nio.file.Files;
+import java.util.ConcurrentModificationException;
 import java.util.UUID;
 import java.util.concurrent.ExecutionException;
 import java.util.concurrent.TimeUnit;
@@ -74,14 +75,18 @@ public class MultiPaper {
     }
 
     private static void checkIfPlayersNeedToBeMoved() {
-        for (Player player : Bukkit.getOnlinePlayers()) {
-            if (player.getLastLogin() < System.currentTimeMillis() - 5 * 1000L) {
-                String server = Zone.getServer(player.getLocation());
+        try {
+            for (Player player : Bukkit.getOnlinePlayers()) {
+                if (player.getLastLogin() < System.currentTimeMillis() - 5 * 1000L) {
+                    String server = Zone.getServer(player.getLocation());
 
-                if (server != null) {
-                    Zone.doMerge(player, server);
+                    if (server != null) {
+                        Zone.doMerge(player, server);
+                    }
                 }
             }
+        } catch (ConcurrentModificationException e) {
+            e.printStackTrace();
         }
     }
 
